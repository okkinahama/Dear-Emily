<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="Z7oeRWlGR5pHAdAnMnSGpV6a00v7iDyDe9WCVB2ALh0" />
  <title>Dear Emily</title>

  <link rel="stylesheet" href="css/style.css">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2597955691662954"
    crossorigin="anonymous"></script>
 
</head>

<body>
  <div class="container">
    <div class="scrollable-menu" id="sideMenu">
    <div class="scrollable-content">
      <ul>
        <li><a href="index.html">HOME</a></li>
        <li><a href="archive.html">Archive</a></li>
        <li><a href="articles.html">Article-List</a></li>
        <li><a href="about-emily.html">About</a></li>
        <li><a href="contact.html">Contact US</a></li>
      </ul>
    </div>
  </div>

  <section id="article-list" class="article-section">
    <div class="top-menu-bar">
      <nav class="main-nav">
        <ul>
          <li><a href="index.html">HOME</a></li>
          <li><a href="archive.html">Archive</a></li>
          <li><a href="articles.html">Article List</a></li> 
          <li><a href="about-emily.html">About</a></li>
          <li><a href="contact.html">Contact Us</a></li>
        </ul>
      </nav>
    </div>

    <header>
      <div class="hamburger-container">
    <div class="hamburger-menu" id="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>

        <nav class="nav-links">
          <ul>
            <li><a href="index.html">HOME</a></li>
            <li><a href="archive.html">Archive</a></li>
            <li><a href="articles.html">Article-List</a></li>
            <li><a href="about-emily.html">About</a></li>
            <li><a href="contact.html">Contact US</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <div class="header-content">
      <h1><a href="index.html">Dear Emily</a></h1>
      <p class="site-description">宇宙をテーマにしたブログ</p>
    </div>
    </div> </header> <style class="container main-content">
    </style>


    <section id="apod-hero">
      <div id="apod-container-hero">
        <h2 id="apod-title-hero">Comet SWAN</h2>
        <div id="apod-media-container-hero">
          <img id="apod-image-hero" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="">
        </div>
        <p id="apod-explanation-hero"></p>
        <p id="apod-copyright-hero"></p>
      </div>
    </section>

    <section class="hero">
      <div class="hero-image"></div>
      <div class="hero-text">
        <h2>Exploring the Mysteries of the Vast Universe</h2>
        <p>最新の宇宙に関するあらゆる情報を発信しています。</p>

        <div class="space-news-section">
          <h3>🌌 Breaking News from the Cosmos（NASAより）</h3>
          <div id="space-news"></div>
        </div>
      </div>
    </section>

    <div class="parallax-space"></div>

    <section id="article-list" class="article-section"> <ul class="article-links">
        <li><a href="articles.html">Go to Article List</a></li>
      </ul>

      <div class="article-list">
        <article class="article-card">
          <h3><a href="articles/space-boder.html">宇宙ってどこから？</a></h3>
          <p>「地球を飛び出したら、すぐ宇宙？」そんな疑問にやさしく答える、宇宙のはじまりのお話。</p>
          <p class="article-date">投稿日：2025年4月21日</p>
        </article>

        <article class="article-card">
          <h3><a href="articles/space-moon.html">お月さまって、毎晩どうして形がちがうの？</a></h3>
          <p>セーラームーンを想いながら、月の満ち欠けについてやさしく解説する物語。</p>
          <p class="article-date">投稿日：2025年4月22日</p>
        </article>

        <article class="article-card">
          <h3><a href="articles/2025-04-24.space.openpage.html">きらめきの入口</a></h3>
          <p>宇宙に関心をもつきっかけになってほしい</p>
          <p class="article-date">投稿日：2025年4月24日</p>
        </article>

        <article class="article-card">
          <h3><a href="articles\2025-04-25.space.mars.html">火星ってどんな星？&gt;</a></h3>
          <p>セーラー・マーズに教えてもらう火星のひみつ</p>
          <p class="article-date">投稿日：2025年4月25日</p>
        </article>

        <article class="article-card">
          <h3><a href="articles\2025-04-26.space.jupiter.html">ジュピターって、どんな星？</a></h3>
          <p>ジュピターのひみつと宇宙の嵐</p>
          <p class="article-date">投稿日：2025年4月26日</p>
        </article>

      </div>
    </section>
<section id="latest-posts" class="section">
    <h2>最新記事</h2>
    <!-- JavaScript で挿入される記事 -->
  </section>

  <aside id="sidebar">
    <h2>カテゴリ別記事</h2>
    <!-- JavaScript でカテゴリごとに記事が入る -->
  </aside>

  <section>
    <h2>全ての記事</h2>
    <label for="category-filter">カテゴリ:</label>
    <select id="category-filter">
      <option value="all">すべて</option>
    </select>

    <label for="tag-filter">タグ:</label>
    <select id="tag-filter">
      <option value="all">すべて</option>
    </select>

    <div id="all-posts" class="section">
      <!-- JSONファイルから取得した記事が入る -->
    </div>
  </section>
    <section class="section about-emily" id="about-emily">
      <h2>About Emily</h2>

      <ul class="about-emily-links">
        <li><a href="about-emily.html">About Emily</a></li>
      </ul>

      <div class="about-content">
        <img src="images/Gemini_Generated_Image_749bad749bad749b.jpg" alt="Emilyのプロフィール画像" class="profile-image">
        <div class="about-text">
          <p>
            ねぇエミリー。<br><br>
            「なんでこんなに宇宙を扱った作品が多いの？」って、<br>
            あなたがポツリとこぼしたあの一言、ずっと心に残ってたんだ。<br><br>
            それに答えたくて、このブログを作ったよ。<br>
            宇宙は、目に見えないけど、心を動かす魔法みたいな場所。<br>
            たとえ遠くても、私たちに届く物語がそこにはあるんだ。<br><br>
            だから一緒に、この広い宇宙をちょっとずつ旅していこう。
          </p>
          <p class="from-author">
            宇宙の魅力、これから一緒に探していこうね。<br>
            — okkinahanaより ✦
          </p>
        </div>
      </div>
    </section>

    <section class="space-weather-container">
      <div class="space-weather-item">
        <h2>Today's Solar Flare Information</h2>
        <div id="solar-flare-container">
          <p>太陽フレア情報を取得中です...</p>
        </div>
      </div>
      <div class="space-weather-item">
        <h2>Today's Geomagnetic Storm Information</h2>
        <div id="geomagnetic-storm-container">
          <p>地磁気嵐情報を取得中です...</p>
        </div>
      </div>
    </section>


    <footer>
      <div class="container">
        <p>&copy; 2025 Dear Emily</p>
        <nav>
          <ul>
            <li><a href="privacy.html">プライバシーポリシー</a></li>
            <li><a href="telms.html">利用規約</a></li>
            <li><a href="sitemap.html">サイトマップ</a></li>
          </ul>
        </nav>
      </div>
    </footer>

    <script>

 document.addEventListener('DOMContentLoaded', () => {
    // --- ハンバーガーメニューの処理 ---
    const hamburgerMenu = document.querySelector('.hamburger-menu');
    const scrollableMenu = document.querySelector('.scrollable-menu');

    if (hamburgerMenu && scrollableMenu) {
        hamburgerMenu.addEventListener('click', () => {
            scrollableMenu.classList.toggle('open');
            hamburgerMenu.classList.toggle('open');
        });
    }

    // --- APOD (Astronomy Picture of the Day) の取得と表示 ---
    const apodApiKey = '2xltSsPMjbXB66oDPVCdT6qPhKURghrTPdbhKEzj';
    const apodUrl = `https://api.nasa.gov/planetary/apod?api_key=${apodApiKey}`;
    const apodTitle = document.getElementById('apod-title-hero');
    const apodMediaContainer = document.getElementById('apod-media-container-hero');
    const apodExplanation = document.getElementById('apod-explanation-hero');
    const apodCopyright = document.getElementById('apod-copyright-hero');
    const apodContainer = document.getElementById('apod-container-hero'); // エラー時用

    fetch(apodUrl)
        .then(res => {
            if (!res.ok) {
                return Promise.reject(res.status);
            }
            return res.json();
        })
        .then(data => {
            if (apodTitle) apodTitle.textContent = data.title;
            if (apodExplanation) apodExplanation.textContent = data.explanation;
            if (apodCopyright) {
                apodCopyright.textContent = data.copyright ? `© ${data.copyright}` : '出典: NASA / パブリックドメインの可能性';
            }

            if (apodMediaContainer) {
                apodMediaContainer.innerHTML = ''; // 既存の内容をクリア

                if (data.media_type === 'video') {
                    const iframe = document.createElement('iframe');
                    iframe.src = data.url;
                    iframe.width = '100%';
                    iframe.style.aspectRatio = '16 / 9'; // アスペクト比を固定
                    iframe.frameBorder = '0';
                    iframe.allowFullscreen = true;
                    apodMediaContainer.appendChild(iframe);
                } else if (data.media_type === 'image') {
                    const img = document.createElement('img');
                    img.src = data.url;
                    img.alt = data.title;
                    img.style.maxWidth = '100%';
                    img.style.height = 'auto';
                    apodMediaContainer.appendChild(img);
                }
            }
        })
        .catch(err => {
            console.error('APOD取得エラー:', err);
            if (apodContainer) {
                apodContainer.innerHTML = '<p>今日の宇宙画像を取得できませんでした。</p>';
            } else if (apodTitle) {
                apodTitle.textContent = '今日の宇宙画像を取得できませんでした';
            }
        });

    // --- 太陽フレア情報の取得 ---
    const flareContainer = document.getElementById('solar-flare-container');
    const today = new Date().toISOString().slice(0, 10);
    const flareUrl = `https://api.nasa.gov/DONKI/FLR?startDate=${today}&endDate=${today}&api_key=${apodApiKey}`;

    fetch(flareUrl)
        .then(res => {
            if (!res.ok) {
                return Promise.reject(res.status);
            }
            return res.json();
        })
        .then(data => {
            if (!flareContainer) return;

            if (data.length === 0) {
                flareContainer.innerHTML = '<p>現在のところ、太陽フレアの活動は観測されていません。</p>';
                return;
            }

            flareContainer.innerHTML = '<ul>' + data.map(f => `
                <li>
                    <div><strong>開始日時:</strong> ${f.beginTime}</div>
                    <div><strong>ピーク日時:</strong> ${f.peakTime}</div>
                    <div><strong>終了日時:</strong> ${f.endTime}</div>
                    <div><strong>強度:</strong> ${f.classType}</div>
                    <div><strong>領域:</strong> ${f.sourceLocation}</div>
                </li>`).join('') + '</ul>';
        })
        .catch(err => {
            console.error('太陽フレア取得エラー:', err);
            if (flareContainer) {
                flareContainer.innerHTML = '<p>太陽フレア情報を取得できませんでした。</p>';
            }
        });

    // --- 地磁気嵐情報の取得 ---
    const stormContainer = document.getElementById('geomagnetic-storm-container');
    const stormUrl = `https://api.nasa.gov/DONKI/GST?startDate=${today}&endDate=${today}&api_key=${apodApiKey}`;

    fetch(stormUrl)
        .then(res => {
            if (!res.ok) {
                return Promise.reject(res.status);
            }
            return res.json();
        })
        .then(data => {
            if (!stormContainer) return;

            if (data.length === 0) {
                stormContainer.innerHTML = '<p>現在のところ、地磁気嵐は観測されていません。</p>';
                return;
            }

            stormContainer.innerHTML = '<ul>' + data.map(s => `
                <li>
                    <strong>開始日時:</strong> ${s.beginTime}<br>
                    <strong>Kp指数:</strong> ${s.kpIndex}<br>
                    <strong>強度:</strong> ${s.gstID}<br>
                    <strong>ソース:</strong> ${s.source}
                </li>`).join('') + '</ul>';
        })
        .catch(err => {
            console.error('地磁気嵐取得エラー:', err);
            if (stormContainer) {
                stormContainer.innerHTML = '<p>地磁気嵐情報を取得できませんでした。</p>';
            }
        });

    // --- NASAニュースRSSの取得 ---
    const rssFeedUrl = 'https://www.nasa.gov/rss/dyn/breaking_news.rss';
    const rssApiUrl = 'https://api.rss2json.com/v1/api.json?rss_url=' + encodeURIComponent(rssFeedUrl);

    fetch(rssApiUrl)
        .then(res => res.json())
        .then(data => {
            const newsContainer = document.getElementById("space-news");
            if (newsContainer && data.items) {
                // 最大5件のニュースを表示
                data.items.slice(0, 5).forEach(item => {
                    const div = document.createElement("div");
                    div.innerHTML = `<a href="${item.link}" target="_blank">${item.title}</a>`;
                    newsContainer.appendChild(div);
                });
            }
        })
        .catch(err => console.error("RSS取得エラー:", err));

    // --- about-emily.htmlの読み込み (未完) ---
    // この部分は現在機能が定義されていないため、そのまま残します。
    // fetch('about-emily.html')
    //     .then(res => {
    //         if (!res.ok) throw new Error('HTMLの読み込みエラー');
    //         // 必要に応じてres.text().then(html => ... ) を追加
    //     })
    //     .catch(err => console.error('about-emily.htmlの読み込みエラー:', err));

    // --- 最新記事の取得と表示 ---
    // カテゴリと最新記事の表示ロジックは統合
    const latestPostsContainer = document.getElementById('latest-posts');
    const sidebarCategoriesContainer = document.getElementById("sidebar-categories"); // 新たなIDを想定 (HTML側で設定)

    fetch('posts.json') // JSONのパスを正しく
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(posts => {
            // 最新記事の表示
            if (latestPostsContainer) {
                const latestPosts = posts
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 5); // 最新5件を表示

                latestPosts.forEach(post => {
                    const div = document.createElement('div');
                    div.className = 'post-item';
                    div.innerHTML = `
                        <h3><a href="${post.url}">${post.title}</a></h3>
                        <p>${post.date} ｜ カテゴリ：${post.category}</p>
                    `;
                    latestPostsContainer.appendChild(div);
                });
            }

            // カテゴリ別の表示 (サイドバーを想定)
            if (sidebarCategoriesContainer) {
                const categoriesMap = {};
                posts.forEach(post => {
                    if (!categoriesMap[post.category]) {
                        categoriesMap[post.category] = [];
                    }
                    categoriesMap[post.category].push(post);
                });

                // カテゴリリストのHTML構造を生成
                const categoryListHtml = `
                    <h2>カテゴリー</h2>
                    <ul class="category-list">
                        ${Object.keys(categoriesMap).map(cat => `
                            <li><a href="category.html?name=${encodeURIComponent(cat)}">${cat} (${categoriesMap[cat].length})</a></li>
                        `).join('')}
                    </ul>
                `;
                sidebarCategoriesContainer.innerHTML = categoryListHtml;
            }
        })
        .catch(error => console.error('記事の読み込みに失敗しました:', error));

    // --- スクロールによるセクション表示 (フェードインアニメーション) ---
    const sections = document.querySelectorAll('.section');
    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
            }
        });
    }, { threshold: 0.2 }); // 20%が表示されたら発火

    sections.forEach(section => observer.observe(section));

    // --- 全投稿表示 + フィルタ機能 (記事一覧ページを想定) ---
    const allPostsContainer = document.getElementById('all-posts');
    const categoryFilter = document.getElementById('category-filter');
    const tagFilter = document.getElementById('tag-filter');

    if (allPostsContainer && categoryFilter && tagFilter) {
        fetch('posts.json')
            .then(res => {
                if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                }
                return res.json();
            })
            .then(posts => {
                const categories = new Set();
                const tags = new Set();

                posts.forEach(post => {
                    categories.add(post.category);
                    post.tags.forEach(tag => tags.add(tag));
                });

                // カテゴリフィルターオプションの追加
                categoryFilter.innerHTML = '<option value="all">全てのカテゴリ</option>';
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categoryFilter.appendChild(option);
                });

                // タグフィルターオプションの追加
                tagFilter.innerHTML = '<option value="all">全てのタグ</option>';
                tags.forEach(tag => {
                    const option = document.createElement('option');
                    option.value = tag;
                    option.textContent = tag;
                    tagFilter.appendChild(option);
                });

                function displayPosts(filtered) {
                    allPostsContainer.innerHTML = '';
                    filtered.forEach(post => {
                        const card = `
                            <div class="post-card">
                                <h2><a href="${post.url}">${post.title}</a></h2>
                                <p class="post-date">${post.date}</p>
                                <p><strong>カテゴリ:</strong> ${post.category}</p>
                                <p><strong>タグ:</strong> ${post.tags ? post.tags.join(', ') : ''}</p>
                            </div>`;
                        allPostsContainer.insertAdjacentHTML('beforeend', card);
                    });
                }

                function filterPosts() {
                    const selectedCategory = categoryFilter.value;
                    const selectedTag = tagFilter.value;
                    const filtered = posts.filter(post => {
                        const catMatch = selectedCategory === 'all' || post.category === selectedCategory;
                        const tagMatch = selectedTag === 'all' || (post.tags && post.tags.includes(selectedTag)); // post.tagsの存在チェックを追加
                        return catMatch && tagMatch;
                    });
                    displayPosts(filtered);
                }

                // フィルターイベントリスナー
                categoryFilter.addEventListener('change', filterPosts);
                tagFilter.addEventListener('change', filterPosts);

                // 初期表示
                filterPosts(); // posts全体を渡す代わりにfilterPostsを呼び出す
            })
            .catch(error => console.error('記事の読み込みに失敗しました:', error));
    }

    // index.htmlのどこかに、about-emily.htmlの内容を表示したい場所があると仮定
const contentArea = document.getElementById('main-content-area'); // 例: id="main-content-area" のdiv要素

// about-emily.htmlの内容を読み込んで表示する関数
function loadAboutEmilyContent() {
    fetch('about-emily.html')
        .then(res => {
            if (!res.ok) {
                // HTTPステータスが200番台以外の場合、エラーを投げる
                throw new Error(`HTMLの読み込みエラー: ${res.status} ${res.statusText}`);
            }
            return res.text(); // HTMLコンテンツをテキストとして取得
        })
        .then(html => {
            if (contentArea) {
                // 取得したHTMLをcontentAreaに挿入
                contentArea.innerHTML = html;

                // もしabout-emily.html内に特定のスクリプトがある場合、
                // ここでそのスクリプトを動的に実行する必要があるかもしれませんが、
                // 一般的にはコンテンツの挿入だけで十分です。
                // 例: about-emily.html内のアニメーションスクリプトは、
                // about-emily.html内に直接記述するのがベストです。
            }
        })
        .catch(err => {
            console.error('about-emily.htmlの読み込みエラー:', err);
            if (contentArea) {
                contentArea.innerHTML = '<p>コンテンツの読み込みに失敗しました。</p>';
            }
        });
}

// 例: ページロード時に自動的に読み込む、またはボタンクリックで読み込む
// ページロード時に自動読み込みする場合:
// loadAboutEmilyContent();

// ボタンクリックで読み込む場合 (index.htmlにボタンがあると仮定):
const aboutLink = document.querySelector('.about-emily-links a[href="about-emily.html"]');
if (aboutLink) {
    aboutLink.addEventListener('click', (event) => {
        event.preventDefault(); // デフォルトのリンク遷移をキャンセル
        loadAboutEmilyContent(); // コンテンツを動的に読み込む
        // 必要に応じてURLを変更 (history.pushState)
        history.pushState(null, '', 'about-emily.html');
    });
}
});


</body>

</html>